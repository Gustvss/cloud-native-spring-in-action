name: Commit Stage
on: push

jobs:
  build:
    name: Build and Test
    runs-on: ubuntu-22.04
    permissions:
      contents: read
      security-events: write
steps:
  - name: Checkout source code
    uses: actions/checkout@v3

  - name: Set up JDK
    uses: actions/setup-java@v3
    with:
      distribution: temurin
      java-version: 17

  - name: OWASP Dependency-Check
    run: mvn dependency-check:check

  - name: SonarQube Scan
    uses: sonarsource/sonarqube-scan-action@v1
    with:
      sonar-token: ${{ secrets.SONAR_TOKEN }}
      scanner-version: 4.6.2

  - name: Build, unit tests and integration tests
    run: mvn clean install
